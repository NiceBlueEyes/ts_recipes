<!-- Creates a list of pages at the current level of the directory hierarchy. -->
{% assign url_parts = page.url | remove_first: '/' | remove: 'index.html' | split: '/' %}
{% assign rm = url_parts | last %}
{% assign base_url = page.url | replace: rm %}
{% assign url_parts_size = url_parts | size %}

<ul>
{% for node in site.pages %}
  {% if node.url contains base_url %}
    {% assign node_url_parts = node.url | remove_first: '/' | remove: 'index.html' | split: '/' %}
    {% assign node_url_parts_size = node_url_parts | size %}
    {% if url_parts_size == node_url_parts_size %}
      <li>{{node.title}}</li>
    {% endif %}
  {% endif %}
{% endfor %}
</ul>
